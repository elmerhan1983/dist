<%- include('partials/head') %>
<%- include('partials/header') %>
<main class="section">
  <div class="container">
    <h1>系列管理</h1>
    <%- include('partials/admin-nav') %>
    <% if (status) { %><p class="admin-status">Status: <%= status %></p><% } %>

    <section class="admin-block">
      <h2>新增系列</h2>
      <form action="/api/admin/series/create" method="post" class="admin-form">
        <label>系列名称(EN) <input name="name" required /></label>
        <label>系列名称(简中) <input name="nameZh" /></label>
        <label>系列名称(繁中) <input name="nameZhTw" /></label>
        <label>排序 <input name="sortOrder" type="number" min="1" value="<%= series.length + 1 %>" /></label>
        <label class="full">系列说明(EN) <textarea name="summary" rows="2"></textarea></label>
        <label class="full">系列说明(简中) <textarea name="summaryZh" rows="2"></textarea></label>
        <label class="full">系列说明(繁中) <textarea name="summaryZhTw" rows="2"></textarea></label>
        <label class="full">系列图片URL <input class="image-input" name="image" placeholder="/images/product-neutral.svg" /></label>
        <div class="admin-actions"><button class="btn btn-primary" type="submit">Create</button></div>
      </form>
    </section>

    <section class="admin-block">
      <h2>现有系列</h2>
      <input class="filter-input" type="search" placeholder="搜索系列名称/ID/说明..." data-filter-target="seriesList" />
      <div id="seriesList">
      <% series.forEach((item) => { %>
      <details class="admin-collapse">
        <summary><strong><%= item.name %></strong> · ID: <%= item.id %> · Sort: <%= item.sortOrder %></summary>
        <article class="admin-item admin-collapse-body">
          <form action="/api/admin/series/<%= item.id %>/update" method="post" class="admin-form">
            <label>系列名称(EN) <input name="name" value="<%= item.name %>" required /></label>
            <label>系列名称(简中) <input name="nameZh" value="<%= item.nameZh || '' %>" /></label>
            <label>系列名称(繁中) <input name="nameZhTw" value="<%= item.nameZhTw || '' %>" /></label>
            <label>排序 <input name="sortOrder" type="number" min="1" value="<%= item.sortOrder %>" /></label>
            <label class="full">系列说明(EN) <textarea name="summary" rows="2"><%= item.summary %></textarea></label>
            <label class="full">系列说明(简中) <textarea name="summaryZh" rows="2"><%= item.summaryZh || '' %></textarea></label>
            <label class="full">系列说明(繁中) <textarea name="summaryZhTw" rows="2"><%= item.summaryZhTw || '' %></textarea></label>
            <label class="full">系列图片URL <input class="image-input" name="image" value="<%= item.image %>" /></label>
            <div class="admin-actions"><button class="btn btn-primary" type="submit">Update</button></div>
          </form>
          <form action="/api/admin/series/<%= item.id %>/delete" method="post" onsubmit="return confirm('Delete this series?')">
            <button class="btn" type="submit">Delete</button>
          </form>
        </article>
      </details>
      <% }) %>
      </div>
    </section>
  </div>
</main>
<%- include('partials/footer') %>
